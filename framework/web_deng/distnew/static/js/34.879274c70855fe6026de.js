webpackJsonp([34],{PQjy:function(e,t){},mbZN:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),l=a.n(i),s=a("4YfN"),n=a.n(s),r=a("9rMa"),o=a("z/Fw"),c=a.n(o),v={name:"",data:function(){return{isIndeterminate:!1,checkAll:!1,visibleCreateLable:!1,visibleRnameLable:!1,rNameLableVal:"",visibleDelLable:!1,visible1:!1,dialogVisible:!1,RegionJson:{},checkListLable:[],visibleCheckListLable:!0,listLabel:[],tableSelect:[],loadingLable:!1}},computed:n()({},Object(r.c)("tags",["lablePager","labelList","pager","type","create","showLable","tagsDriverList","tagsDriverBind","tagsDriverUnbind"]),Object(r.b)("tags",["conditionsDriver"])),watch:{visibleRnameLable:function(){this.rNameLableVal=this.showLable.res.title}},created:function(){this.loadLable(),this.$store.dispatch("tags/tagsDriverList"),this.RegionJson=c.a},methods:{search:function(){this.$store.dispatch("tags/tagsDriverList")},handleCheckAllChange:function(e){var t=this;this.isIndeterminate=!1,e?this.tagsDriverList.res.forEach(function(e){t.$refs.labelListref.toggleRowSelection(e,!0)}):this.tagsDriverList.res.forEach(function(e){t.$refs.labelListref.toggleRowSelection(e,!1)})},handleSelectionChange:function(e){var t=this;this.checkListLable=[],e.length>0?this.visibleCheckListLable=!1:this.visibleCheckListLable=!0,1==e.length&&e[0].tags.map(function(e){t.checkListLable.push(e.id)}),0==e.length?this.isIndeterminate=!1:e.length==this.tagsDriverList.res.length?this.isIndeterminate=!1:this.isIndeterminate=!0,this.tableSelect=e},changePage:function(e){this.tagsDriverList.page=e,this.$store.dispatch("tags/tagsDriverList"),this.checkAll=!1},rNameLable:function(){var e=this,t={id:this.showLable.res.id,title:this.rNameLableVal,type:1};this.$store.dispatch("tags/update",t).then(function(t){e.loadLable(),e.showLable.res.title=e.rNameLableVal,e.changePage(e.tagsDriverList.page),e.visibleRnameLable=!1})},delLable:function(){var e=this,t={id:this.showLable.res.id,type:1};this.$store.dispatch("tags/labelDestroy",t).then(function(t){e.showLable.res.title="",e.showLable.res.id=0,e.visibleDelLable=!1,e.loadLable(),e.lableItem()})},createLable:function(){var e=this,t={title:this.create.title,type:1};this.$store.dispatch("tags/create",t).then(function(t){e.loadLable(e.lablePager.page),e.create.title="",e.visibleCreateLable=!1})},lableItem:function(e){var t=this;this.checkAll=!1,e?(this.tagsDriverList.tags_id=e.id,this.showLable.res=e):(this.tagsDriverList.tags_id="",this.showLable.res={id:0}),this.tagsDriverList.page=1,this.tagsDriverList.total=1,this.$store.dispatch("tags/tagsDriverList").then(function(a){e||(t.tagsDriverListAll=t.tagsDriverList.res)})},changeLable:function(){var e=this,t=[],a=[],i=[];this.tableSelect.map(function(t){var a={id:t.id,tags:[],tagsAdd:[],tagsDel:[]};t.tags.map(function(e){a.tags.push(e.id)}),a.tagsAdd=e._.difference(e.checkListLable,a.tags),e.tableSelect.length<=1&&(a.tagsDel=e._.difference(a.tags,e.checkListLable)),i.push(a)}),i.map(function(e){e.tagsAdd.map(function(t){a.push({tags_id:t,driver_id:e.id})}),e.tagsDel.map(function(a){t.push({tags_id:a,driver_id:e.id})})}),this.tagsDriverBind.tags_driver=l()(a),this.tagsDriverUnbind.tags_driver=l()(t),this.loadingLable=!0,a.length>0?this.$store.dispatch("tags/tagsDriverBind").then(function(a){e.tableSelect.length<=1&&t.length>0?e.$store.dispatch("tags/tagsDriverUnbind").then(function(t){e.loadingLable=!1,e.changePage(e.tagsDriverList.page),e.loadLable(e.lablePager.page),e.visible1=!1}):(e.loadingLable=!1,e.changePage(e.tagsDriverList.page),e.loadLable(e.lablePager.page),e.visible1=!1)}):t.length>0?(this.loadingLable=!1,this.$store.dispatch("tags/tagsDriverUnbind").then(function(t){e.changePage(e.tagsDriverList.page),e.loadLable(e.lablePager.page),e.visible1=!1})):(this.loadingLable=!1,this.visible1=!1)},changeLablePage:function(e){this.lablePager.page=e,this.loadLable()},loadLable:function(){var e=this,t={type:1,page:this.lablePager.page,count:this.lablePager.count,total:1};this.$store.dispatch("tags/labelList",t).then(function(t){e.lablePager.res=t.list,e.lablePager.total=t.list_total||e.lablePager.total,e.checkAll=!1})}},mounted:function(){}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-driver-lable"},[a("el-row",{staticClass:"wrap",attrs:{type:"flex"}},[a("el-col",{staticClass:"left-side",attrs:{span:4}},[a("ul",{staticClass:"list"},[a("li",{class:{active:0==e.showLable.res.id},on:{click:function(t){e.lableItem()}}},[e._v("全部 ("+e._s(e.lablePager.total)+")")]),e._v(" "),e._l(e.lablePager.res,function(t){return a("li",{key:t.id,class:{active:e.showLable.res.id==t.id},on:{click:function(a){e.lableItem(t)}}},[e._v(e._s(t.title)+" ("+e._s(t.total)+")")])})],2),e._v(" "),e.lablePager.total>e.lablePager.count?a("pnation",{attrs:{currentPage:e.lablePager.page,total:e.lablePager.total,size:e.lablePager.count},on:{changePage:e.changeLablePage}}):e._e()],1),e._v(" "),a("el-col",{staticClass:"right-side",attrs:{span:20}},[a("div",{staticClass:"rside-inside"},[a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:12}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"手机号码"},model:{value:e.tagsDriverList.mobile,callback:function(t){e.$set(e.tagsDriverList,"mobile",t)},expression:"tagsDriverList.mobile"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.search()}}},[e._v("查　询")])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-popover",{ref:"popover1",attrs:{placement:"bottom",width:"160"},model:{value:e.visibleCreateLable,callback:function(t){e.visibleCreateLable=t},expression:"visibleCreateLable"}},[a("h4",{staticStyle:{margin:"0"}},[e._v("标签名称")]),e._v(" "),a("div",{staticClass:"line1"}),e._v(" "),a("el-input",{model:{value:e.create.title,callback:function(t){e.$set(e.create,"title",t)},expression:"create.title"}}),e._v(" "),a("div",{staticClass:"line1"}),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visibleCreateLable=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.createLable()}}},[e._v("确定")])],1)],1),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popover1",arg:"popover1"}],staticClass:"btn-new",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){e.visibleCreateLable=!0}}},[e._v("新建标签")])],1)],1),e._v(" "),a("div",{staticClass:"line2"}),e._v(" "),a("el-row",{attrs:{type:"flex",gutter:20,justify:"space-between"}},[a("el-col",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingLable,expression:"loadingLable"}],attrs:{span:24,"element-loading-background":"rgba(255, 255, 255, 0.5)"}},[a("div",{staticClass:"hd-ctrl clearfix"},[a("i",{staticClass:"el-icon-info"}),e._v(" \n              "),0!==e.showLable.res.id?[a("span",{staticClass:"labeltxt"},[e._v(e._s(e.showLable.res.title))]),e._v(" "),a("el-popover",{ref:"popover2",attrs:{placement:"bottom",width:"160"},model:{value:e.visibleRnameLable,callback:function(t){e.visibleRnameLable=t},expression:"visibleRnameLable"}},[a("h4",{staticStyle:{margin:"0"}},[e._v("标签名称")]),e._v(" "),a("div",{staticClass:"line1"}),e._v(" "),a("el-input",{model:{value:e.rNameLableVal,callback:function(t){e.rNameLableVal=t},expression:"rNameLableVal"}}),e._v(" "),a("div",{staticClass:"line1"}),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visibleRnameLable=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.rNameLable}},[e._v("确定")])],1)],1),e._v(" "),a("el-popover",{ref:"popover3",attrs:{placement:"bottom",width:"160"},model:{value:e.visibleDelLable,callback:function(t){e.visibleDelLable=t},expression:"visibleDelLable"}},[a("p",[e._v("确定删除吗?")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visibleDelLable=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.delLable}},[e._v("确定")])],1)]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popover2",arg:"popover2"}]},[e._v("重命名")]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popover3",arg:"popover3"}],attrs:{type:"danger"}},[e._v("删除")])]:[a("span",[e._v("全部司机方用户")])]],2),e._v(" "),a("el-popover",{ref:"popover1",staticClass:"popover1",attrs:{placement:"top",width:"425"},model:{value:e.visible1,callback:function(t){e.visible1=t},expression:"visible1"}},[a("div",[a("div",{staticClass:"checkbox-box"},[a("el-checkbox-group",{model:{value:e.checkListLable,callback:function(t){e.checkListLable=t},expression:"checkListLable"}},e._l(e.lablePager.res,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.title))])}))],1),e._v(" "),a("div",{staticClass:"line2"}),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visible1=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.changeLable}},[e._v("确定")])],1)])]),e._v(" "),a("div",{staticClass:"line1"}),e._v(" "),a("div",{staticClass:"hd hd-left"},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v("    \n              "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popover1",arg:"popover1"}],attrs:{size:"mini",disabled:e.visibleCheckListLable}},[e._v("打标签")])],1),e._v(" "),a("el-table",{ref:"labelListref",staticClass:"table-nobderheader",attrs:{"show-header":!1,border:"",data:e.tagsDriverList.res,"row-class-name":"user-list"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"35"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"",width:"70"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:e.row.portrait,alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  姓名 : "+e._s(t.row.driver_name)+"\n                  \n                  "),e._v(" "),a("div",{staticClass:"labelground"},e._l(t.row.tags,function(t){return a("el-button",{key:t.id,staticClass:"labelitem",attrs:{type:"success",plain:"",size:"mini"}},[e._v(e._s(t.tag_title))])}))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  手机号码 : "+e._s(t.row.mobile)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  所属城市 : "+e._s(e.RegionJson[t.row.province][t.row.city])+"\n                ")]}}])})],1),e._v(" "),e.tagsDriverList.total>0?a("pnation",{attrs:{total:e.tagsDriverList.total,size:e.tagsDriverList.count,currentPage:e.tagsDriverList.page},on:{changePage:e.changePage}}):e._e()],1)],1)],1)])],1)],1)},staticRenderFns:[]};var g=a("Z0/y")(v,b,!1,function(e){a("PQjy")},"data-v-3df0fd66",null);t.default=g.exports}});
//# sourceMappingURL=34.879274c70855fe6026de.js.map